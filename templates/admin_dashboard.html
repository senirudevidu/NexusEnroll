<!-- admin.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NexusEnroll Admin</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/admin.css') }}"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="admin-header">
      <div class="logo">
        NexusEnroll <span class="portal">Administrator Portal</span>
      </div>
      <button class="back-btn" onclick="window.location.href='/'">
        Back to Main
      </button>
    </header>

    <!-- Welcome Section -->
    <div class="welcome">
      <h2>Welcome, {{firstName}} {{lastName}}</h2>
      <p>Administrator ID: ADM2024001 | University of California</p>
    </div>

    <!-- Tabs -->
    <nav class="tabs">
      <button onclick="showTab('course-management')" class="active">
        Course Management
      </button>
      <button onclick="showTab('course-requests')">Course Requests</button>
      <button onclick="showTab('user-management')">User Management</button>
      <button onclick="showTab('reports')">Reports & Analytics</button>
      <button onclick="showTab('settings')">System Settings</button>
    </nav>

    <!-- Content -->
    <main class="content">
      <!-- Course Management -->
      <section id="course-management" class="tab-content active">
        <div class="section-header">
          <h3>Course Management</h3>
          <div class="button-group">
            <button class="add-btn" onclick="window.location.href='/course'">
              + Add Course
            </button>
            <button class="add-btn" onclick="window.location.href='/degrees'">
              + Add Degree
            </button>
            <button
              class="add-btn"
              onclick="window.location.href='/departments'"
            >
              + Add Department
            </button>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Course Name</th>
              <th>Instructor</th>
              <th>Department</th>
              <th>Enrollment</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="course-table-body">
            <!-- Dynamic rows will be inserted here -->
          </tbody>
        </table>
      </section>

      <!-- Course Requests Management -->
      <section id="course-requests" class="tab-content">
        <div class="section-header">
          <h3>Course Change Requests</h3>
          <div class="request-stats">
            <span class="stat-item">
              <span class="stat-label">Pending:</span>
              <span class="stat-value" id="pending-count">0</span>
            </span>
            <span class="stat-item">
              <span class="stat-label">Total Requests:</span>
              <span class="stat-value" id="total-requests">0</span>
            </span>
          </div>
        </div>

        <div class="requests-container">
          <div class="filters-section">
            <label for="status-filter">Filter by Status:</label>
            <select id="status-filter" onchange="filterRequests()">
              <option value="all">All Requests</option>
              <option value="Pending" selected>Pending Only</option>
              <option value="Approved">Approved</option>
              <option value="Rejected">Rejected</option>
            </select>
          </div>

          <table id="requests-table">
            <thead>
              <tr>
                <th>Request ID</th>
                <th>Faculty</th>
                <th>Course</th>
                <th>Type</th>
                <th>Details</th>
                <th>Submitted</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="requests-table-body">
              <!-- Dynamic rows will be inserted here -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- User Management -->
      <section id="user-management" class="tab-content">
        <div class="section-header">
          <h3>User Management</h3>
          <button class="add-btn" onclick="window.location.href='/addUserForm'">
            + Add User
          </button>
        </div>
        <table>
          <thead>
            <tr>
              <th>User ID</th>
              <th>Name</th>
              <th>Role</th>
              <th>Department</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="user-table-body">
            <!-- Student rows will be inserted here -->
          </tbody>
          <tbody id="faculty-table-body">
            <!-- Faculty rows will be inserted here -->
          </tbody>
        </table>
      </section>

      <!-- Reports -->
      <section id="reports" class="tab-content">
        <div class="section-header">
          <h3>Reports & Analytics</h3>
          <div class="button-group">
            <button
              class="add-btn"
              onclick="window.location.href='/reports'"
              style="
                background: #2563eb;
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                font-weight: 600;
              "
            >
              üìä Open Full Analytics Dashboard
            </button>
            <button
              class="add-btn"
              onclick="generateQuickBusinessReport()"
              style="
                background: #059669;
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                font-weight: 600;
              "
            >
              üìà Business School Quick Report
            </button>
            <button
              class="add-btn"
              onclick="generateHighCapacityAlert()"
              style="
                background: #dc2626;
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                font-weight: 600;
              "
            >
              ‚ö†Ô∏è High Capacity Alert
            </button>
          </div>
        </div>

        <!-- Quick Analytics Cards -->
        <div class="reports-overview">
          <div
            class="analytics-grid"
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
              gap: 20px;
              margin: 20px 0;
            "
          >
            <!-- Enrollment Overview Card -->
            <div
              class="metric-card"
              style="
                background: white;
                border-radius: 12px;
                padding: 20px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 12px;
                  margin-bottom: 16px;
                "
              >
                <div
                  style="
                    width: 48px;
                    height: 48px;
                    background: #3b82f6;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 20px;
                  "
                >
                  üìö
                </div>
                <div>
                  <h4 style="margin: 0; color: #1e293b">Total Enrollments</h4>
                  <p style="margin: 0; color: #64748b; font-size: 14px">
                    System-wide
                  </p>
                </div>
              </div>
              <div style="text-align: center">
                <div
                  id="totalEnrollmentsMetric"
                  style="font-size: 2rem; font-weight: 700; color: #1e293b"
                >
                  -
                </div>
                <div style="color: #10b981; font-size: 14px; font-weight: 500">
                  <span id="enrollmentTrend">Loading...</span>
                </div>
              </div>
            </div>

            <!-- Faculty Workload Card -->
            <div
              class="metric-card"
              style="
                background: white;
                border-radius: 12px;
                padding: 20px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 12px;
                  margin-bottom: 16px;
                "
              >
                <div
                  style="
                    width: 48px;
                    height: 48px;
                    background: #10b981;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 20px;
                  "
                >
                  üë®‚Äçüè´
                </div>
                <div>
                  <h4 style="margin: 0; color: #1e293b">Active Faculty</h4>
                  <p style="margin: 0; color: #64748b; font-size: 14px">
                    Teaching courses
                  </p>
                </div>
              </div>
              <div style="text-align: center">
                <div
                  id="activeFacultyMetric"
                  style="font-size: 2rem; font-weight: 700; color: #1e293b"
                >
                  -
                </div>
                <div style="color: #10b981; font-size: 14px; font-weight: 500">
                  <span id="facultyWorkloadTrend">Loading...</span>
                </div>
              </div>
            </div>

            <!-- High Capacity Alert Card -->
            <div
              class="metric-card"
              style="
                background: white;
                border-radius: 12px;
                padding: 20px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 12px;
                  margin-bottom: 16px;
                "
              >
                <div
                  style="
                    width: 48px;
                    height: 48px;
                    background: #ef4444;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 20px;
                  "
                >
                  ‚ö†Ô∏è
                </div>
                <div>
                  <h4 style="margin: 0; color: #1e293b">High Capacity</h4>
                  <p style="margin: 0; color: #64748b; font-size: 14px">
                    Courses >90%
                  </p>
                </div>
              </div>
              <div style="text-align: center">
                <div
                  id="highCapacityMetric"
                  style="font-size: 2rem; font-weight: 700; color: #1e293b"
                >
                  -
                </div>
                <div style="color: #ef4444; font-size: 14px; font-weight: 500">
                  <span id="capacityTrend">Loading...</span>
                </div>
              </div>
            </div>

            <!-- Department Performance Card -->
            <div
              class="metric-card"
              style="
                background: white;
                border-radius: 12px;
                padding: 20px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              "
            >
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 12px;
                  margin-bottom: 16px;
                "
              >
                <div
                  style="
                    width: 48px;
                    height: 48px;
                    background: #f59e0b;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 20px;
                  "
                >
                  üè¢
                </div>
                <div>
                  <h4 style="margin: 0; color: #1e293b">Avg Utilization</h4>
                  <p style="margin: 0; color: #64748b; font-size: 14px">
                    All departments
                  </p>
                </div>
              </div>
              <div style="text-align: center">
                <div
                  id="avgUtilizationMetric"
                  style="font-size: 2rem; font-weight: 700; color: #1e293b"
                >
                  -
                </div>
                <div style="color: #f59e0b; font-size: 14px; font-weight: 500">
                  <span id="utilizationTrend">Loading...</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Quick Actions Section -->
          <div
            class="quick-actions-section"
            style="
              background: white;
              border-radius: 12px;
              padding: 24px;
              margin: 20px 0;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <h4
              style="
                margin: 0 0 16px 0;
                color: #1e293b;
                display: flex;
                align-items: center;
                gap: 8px;
              "
            >
              <span
                style="
                  width: 24px;
                  height: 24px;
                  background: #3b82f6;
                  border-radius: 4px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  color: white;
                  font-size: 14px;
                "
                >‚ö°</span
              >
              Quick Report Actions
            </h4>
            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 12px;
              "
            >
              <div
                style="
                  border: 1px solid #e2e8f0;
                  border-radius: 8px;
                  padding: 16px;
                  cursor: pointer;
                  transition: all 0.2s;
                "
                onclick="generateQuickBusinessReport()"
                onmouseover="this.style.borderColor='#3b82f6'; this.style.backgroundColor='#f8fafc'"
                onmouseout="this.style.borderColor='#e2e8f0'; this.style.backgroundColor='white'"
              >
                <div
                  style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    margin-bottom: 8px;
                  "
                >
                  <span style="color: #3b82f6; font-size: 18px">üìä</span>
                  <strong style="color: #1e293b">Business School Focus</strong>
                </div>
                <p style="margin: 0; color: #64748b; font-size: 14px">
                  Generate report for Business school courses over 90% capacity
                </p>
              </div>

              <div
                style="
                  border: 1px solid #e2e8f0;
                  border-radius: 8px;
                  padding: 16px;
                  cursor: pointer;
                  transition: all 0.2s;
                "
                onclick="window.location.href='/reports'"
                onmouseover="this.style.borderColor='#10b981'; this.style.backgroundColor='#f0fdf4'"
                onmouseout="this.style.borderColor='#e2e8f0'; this.style.backgroundColor='white'"
              >
                <div
                  style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    margin-bottom: 8px;
                  "
                >
                  <span style="color: #10b981; font-size: 18px">üìà</span>
                  <strong style="color: #1e293b">Full Dashboard</strong>
                </div>
                <p style="margin: 0; color: #64748b; font-size: 14px">
                  Access comprehensive analytics with charts and export options
                </p>
              </div>

              <div
                style="
                  border: 1px solid #e2e8f0;
                  border-radius: 8px;
                  padding: 16px;
                  cursor: pointer;
                  transition: all 0.2s;
                "
                onclick="generateFacultyWorkloadReport()"
                onmouseover="this.style.borderColor='#f59e0b'; this.style.backgroundColor='#fffbeb'"
                onmouseout="this.style.borderColor='#e2e8f0'; this.style.backgroundColor='white'"
              >
                <div
                  style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    margin-bottom: 8px;
                  "
                >
                  <span style="color: #f59e0b; font-size: 18px">üë•</span>
                  <strong style="color: #1e293b">Faculty Workload</strong>
                </div>
                <p style="margin: 0; color: #64748b; font-size: 14px">
                  View detailed faculty course loads and student counts
                </p>
              </div>
            </div>
          </div>

          <!-- Recent High Capacity Alerts -->
          <div
            id="recentAlertsSection"
            style="
              background: white;
              border-radius: 12px;
              padding: 24px;
              margin: 20px 0;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <h4
              style="
                margin: 0 0 16px 0;
                color: #1e293b;
                display: flex;
                align-items: center;
                gap: 8px;
              "
            >
              <span
                style="
                  width: 24px;
                  height: 24px;
                  background: #ef4444;
                  border-radius: 4px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  color: white;
                  font-size: 14px;
                "
                >‚ö†Ô∏è</span
              >
              Recent High Capacity Alerts
            </h4>
            <div
              id="alertsList"
              style="display: flex; flex-direction: column; gap: 8px"
            >
              <p style="color: #64748b; font-style: italic">
                Loading recent alerts...
              </p>
            </div>
          </div>
        </div>

        <h3 class="report-title">Enrollment Statistics (Legacy View)</h3>
        <div class="card-container" id="enrollment-report-container">
          <!-- Enrollment cards will be dynamically inserted here by JS -->
        </div>
        <div id="enrollment-error" class="error" style="display: none">
          No enrollment report data available.
        </div>

        <h3 class="report-title">Faculty Workload (Legacy View)</h3>
        <div class="card-container" id="faculty-workload-container">
          <!-- Faculty workload cards will be dynamically inserted here by JS -->
        </div>
        <div id="faculty-error" class="error" style="display: none">
          No faculty workload report data available.
        </div>
      </section>

      <!-- Settings -->
      <section id="settings" class="tab-content">
        <h3>System Settings</h3>
        <div class="settings-card">
          <h4>Enrollment Settings</h4>
          <div class="setting-item">
            <span>Auto-enroll from waitlist</span>
            <button class="add-btn">Configure</button>
          </div>
          <div class="setting-item">
            <span>Registration periods</span>
            <button class="add-btn">Manage</button>
          </div>

          <h4>Notification Settings</h4>
          <div class="setting-item">
            <span>Email notifications</span>
            <button class="add-btn">Configure</button>
          </div>
          <div class="setting-item">
            <span>System alerts</span>
            <button class="add-btn">Manage</button>
          </div>
        </div>
      </section>
    </main>

    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ajaxHelper.js') }}"></script>
  </body>
</html>
